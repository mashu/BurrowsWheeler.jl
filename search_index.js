var documenterSearchIndex = {"docs":
[{"location":"#BurrowsWheeler.jl","page":"Overview","title":"BurrowsWheeler.jl","text":"","category":"section"},{"location":"","page":"Overview","title":"Overview","text":"High-performance Burrows-Wheeler Transform and FM-index implementation in Julia for genomic sequence analysis with exact and approximate pattern matching.","category":"page"},{"location":"#Installation","page":"Overview","title":"Installation","text":"","category":"section"},{"location":"","page":"Overview","title":"Overview","text":"using Pkg\nPkg.add(\"BurrowsWheeler\")","category":"page"},{"location":"#Quick-Start","page":"Overview","title":"Quick Start","text":"","category":"section"},{"location":"","page":"Overview","title":"Overview","text":"using BurrowsWheeler\nusing BioSequences\n\n# Create a DNA sequence\nsequence = dna\"ATAATA\"\n\n# Build FM-index for fast pattern searching\nfm = build_fmindex(sequence)\n\n# Exact pattern matching\nsp, ep = search(fm, dna\"ATA\")  # Returns (start_position, end_position)\ncount = count_occurrences(fm, dna\"ATA\")  # Returns 2\npositions = locate(fm, dna\"ATA\")  # Returns [1, 4]\n\n# Approximate pattern matching (with substitutions, insertions, deletions)\nmatches = approximate_search(fm, dna\"ATGG\"; max_edits=1)  # Find matches with up to 1 edit\nbest_positions = approximate_locate(fm, dna\"ATGG\"; max_edits=1)  # Returns [1, 5]","category":"page"},{"location":"#Examples","page":"Overview","title":"Examples","text":"","category":"section"},{"location":"#Burrows-Wheeler-Transform","page":"Overview","title":"Burrows-Wheeler Transform","text":"","category":"section"},{"location":"","page":"Overview","title":"Overview","text":"using BurrowsWheeler\nusing BioSequences\n\nsequence = dna\"ATAATA\"\n\n# Compute suffix array using O(n) SA-IS algorithm\nsa_result = sa(sequence)\n\n# Compute BWT from suffix array\nbwt_result = bwt(sequence)\n\n# Reverse BWT to recover original sequence\noriginal = revbwt(bwt_result)  # Returns dna\"ATAATA\"","category":"page"},{"location":"#Working-with-Different-Sequence-Types","page":"Overview","title":"Working with Different Sequence Types","text":"","category":"section"},{"location":"","page":"Overview","title":"Overview","text":"using BurrowsWheeler\nusing BioSequences\n\n# DNA sequences\ndna_seq = dna\"ATCGATCG\"\nfm_dna = build_fmindex(dna_seq)\ncount_occurrences(fm_dna, dna\"ATCG\")  # Returns 2\n\n# RNA sequences\nrna_seq = rna\"AUAUAU\"\nfm_rna = build_fmindex(rna_seq)\ncount_occurrences(fm_rna, rna\"AUA\")  # Returns 2","category":"page"},{"location":"#Approximate-Pattern-Matching","page":"Overview","title":"Approximate Pattern Matching","text":"","category":"section"},{"location":"","page":"Overview","title":"Overview","text":"Find approximate matches allowing substitutions, insertions, and deletions:","category":"page"},{"location":"","page":"Overview","title":"Overview","text":"using BurrowsWheeler\nusing BioSequences\n\n# Build FM-index\ngenome = dna\"ATCGATCGATCG\"\nfm = build_fmindex(genome)\n\n# Search with up to 1 edit (substitution, insertion, or deletion)\npattern = dna\"ATGG\"\nmatches = approximate_search(fm, pattern; max_edits=1)\n\n# Each match contains:\n# - position: 1-based position in the original sequence\n# - edit_distance: number of edits (substitutions, insertions, deletions)\n# - alignment_length: length of the alignment\n\nfor match in matches\n    println(\"Position: \", match.position, \", Edit distance: \", match.edit_distance)\nend\n\n# Or just get positions\npositions = approximate_locate(fm, pattern; max_edits=1)","category":"page"},{"location":"#API-Reference","page":"Overview","title":"API Reference","text":"","category":"section"},{"location":"#Core-Functions","page":"Overview","title":"Core Functions","text":"","category":"section"},{"location":"#BurrowsWheeler.bwmcol-Union{Tuple{Dict{S, Int64}}, Tuple{S}} where S","page":"Overview","title":"BurrowsWheeler.bwmcol","text":"bwmcol(counts::Dict{S,Int64}) where {S}\n\nReturns counts for the first column of bwt_naïve().\n\n\n\n\n\n","category":"method"},{"location":"#BurrowsWheeler.bwt-Union{Tuple{BioSequences.BioSequence{A}}, Tuple{A}} where A<:BioSequences.Alphabet","page":"Overview","title":"BurrowsWheeler.bwt","text":"bwt(word::BioSequence{A}) where {A <: Alphabet}\n\nReturns BurrowsWheeler transformation using sorted suffix array.\n\n\n\n\n\n","category":"method"},{"location":"#BurrowsWheeler.bwt_naïve-Union{Tuple{BioSequences.BioSequence{A}}, Tuple{A}} where A<:BioSequences.Alphabet","page":"Overview","title":"BurrowsWheeler.bwt_naïve","text":"bwt_naïve(word::BioSequence{A}) where {A <: Alphabet}\n\nReturns BurrowsWheeler transformation using naïve implementation with two dimensional array.\n\n\n\n\n\n","category":"method"},{"location":"#BurrowsWheeler.rank-Union{Tuple{Vector{S}}, Tuple{S}} where S","page":"Overview","title":"BurrowsWheeler.rank","text":"rank(bw::Vector{S}) where {S}\n\nReturns ranks for the bwt(W) and counts for occurrences of each symbol.\n\n\n\n\n\n","category":"method"},{"location":"#BurrowsWheeler.revbwt-Union{Tuple{A}, Tuple{S}, Tuple{Vector{S}, Type{A}}} where {S, A<:BioSequences.Alphabet}","page":"Overview","title":"BurrowsWheeler.revbwt","text":"revbwt(bw::Vector{S}, alphabet_type::Type{A}) where {S, A <: Alphabet}\n\nReturns reverse of Burrows Wheeler transformation bwt() function.\n\n\n\n\n\n","category":"method"},{"location":"#BurrowsWheeler.revbwt-Union{Tuple{Vector{S}}, Tuple{S}} where S","page":"Overview","title":"BurrowsWheeler.revbwt","text":"revbwt(bw::Vector{S}) where {S}\n\nReturns reverse of Burrows Wheeler transformation bwt() function.\n\n\n\n\n\n","category":"method"},{"location":"#BurrowsWheeler.sa-Union{Tuple{BioSequences.BioSequence{A}}, Tuple{A}} where A<:BioSequences.Alphabet","page":"Overview","title":"BurrowsWheeler.sa","text":"sa(word::BioSequence{A}) where {A <: Alphabet}\n\nReturns the indices of lexicographically sorted suffix array. Uses O(n) SA-IS algorithm via SuffixArrays.jl.\n\n\n\n\n\n","category":"method"},{"location":"#Search-Functions","page":"Overview","title":"Search Functions","text":"","category":"section"},{"location":"#BurrowsWheeler.Search.ApproxMatch","page":"Overview","title":"BurrowsWheeler.Search.ApproxMatch","text":"ApproxMatch\n\nRepresents an approximate match found during approximate search.\n\nFields\n\nposition: 1-based position in the original sequence where the match starts\nedit_distance: Edit distance (number of substitutions, insertions, deletions)\nalignment_length: Length of the alignment (may differ from pattern length due to indels)\n\n\n\n\n\n","category":"type"},{"location":"#BurrowsWheeler.Search.FMIndex","page":"Overview","title":"BurrowsWheeler.Search.FMIndex","text":"FMIndex{S, A <: Alphabet}\n\nFM-index data structure for efficient pattern matching in genomic sequences.\n\nFields\n\nbwt: Burrows-Wheeler Transform of the sequence\nC: First column mapping (cumulative counts)\nrank_arrays: Rank arrays for each symbol\nsa_sample: Sampled suffix array values\nsa_sample_pos: Positions of sampled suffix array entries\nsample_rate: Sampling rate for suffix array\n\n\n\n\n\n","category":"type"},{"location":"#BurrowsWheeler.Search._approximate_search_backtrack-Union{Tuple{A}, Tuple{S}, Tuple{FMIndex{S, A}, BioSequences.BioSequence{A}, Int64, Int64, Int64, Int64, Int64, Int64, Vector{ApproxMatch}, Set{Tuple{Int64, Int64, Int64}}}} where {S, A<:BioSequences.Alphabet}","page":"Overview","title":"BurrowsWheeler.Search._approximate_search_backtrack","text":"_approximate_search_backtrack(fm::FMIndex{S, A}, pattern::BioSequence{A}, \n                               sp::Int64, ep::Int64, pattern_idx::Int64,\n                               max_edits::Int64, current_edits::Int64,\n                               text_chars_consumed::Int64,\n                               results::Vector{ApproxMatch}, \n                               visited::Set{Tuple{Int64, Int64, Int64}}) where {S, A <: Alphabet}\n\nRecursive backtracking function for approximate search with edit distance.\n\nThis function explores all possible paths in the FM-index that match the pattern within the maximum edit distance, allowing substitutions, insertions, and deletions.\n\nArguments\n\ntext_chars_consumed: Number of characters from the text that have been consumed so far.                        This is used to calculate the actual alignment length.\n\n\n\n\n\n","category":"method"},{"location":"#BurrowsWheeler.Search._backward_search_step-Union{Tuple{A}, Tuple{S}, Tuple{FMIndex{S, A}, S, Int64, Int64}} where {S, A<:BioSequences.Alphabet}","page":"Overview","title":"BurrowsWheeler.Search._backward_search_step","text":"_backward_search_step(fm::FMIndex{S, A}, c::S, sp::Int64, ep::Int64) where {S, A <: Alphabet}\n\nPerform a single step of backward search for character c in the range [sp, ep].\n\nReturns the new range (spnew, epnew) after extending with character c.\n\n\n\n\n\n","category":"method"},{"location":"#BurrowsWheeler.Search.approximate_locate-Union{Tuple{A}, Tuple{S}, Tuple{FMIndex{S, A}, BioSequences.BioSequence{A}}} where {S, A<:BioSequences.Alphabet}","page":"Overview","title":"BurrowsWheeler.Search.approximate_locate","text":"approximate_locate(fm::FMIndex{S, A}, pattern::BioSequence{A}, \n                  max_edits::Int64) where {S, A <: Alphabet}\n\nFind the best approximate match positions for a pattern within a maximum edit distance.\n\nThis is a convenience function that returns just the positions of the best matches (smallest edit distance) for each unique position.\n\nArguments\n\nfm: The FM-index to search in\npattern: The pattern to search for\nmax_edits: Maximum allowed edit distance (default: 2)\n\nReturns\n\nA vector of 1-based positions representing the best approximate matches. Each position appears at most once, and matches are sorted by position.\n\nExamples\n\nfm = build_fmindex(dna\"ATCGATCG\")\npositions = approximate_locate(fm, dna\"ATGG\", max_edits=1)\n\n\n\n\n\n","category":"method"},{"location":"#BurrowsWheeler.Search.approximate_search-Union{Tuple{A}, Tuple{S}, Tuple{FMIndex{S, A}, BioSequences.BioSequence{A}}} where {S, A<:BioSequences.Alphabet}","page":"Overview","title":"BurrowsWheeler.Search.approximate_search","text":"approximate_search(fm::FMIndex{S, A}, pattern::BioSequence{A}, \n                  max_edits::Int64) where {S, A <: Alphabet}\n\nFind all approximate matches of a pattern in the FM-index within a maximum edit distance.\n\nThis function uses a backtracking algorithm to explore all possible alignments allowing substitutions, insertions, and deletions. The edit distance is the total number of these operations needed to align the pattern with a substring of the text.\n\nArguments\n\nfm: The FM-index to search in\npattern: The pattern to search for\nmax_edits: Maximum allowed edit distance (default: 2)\n\nReturns\n\nA vector of ApproxMatch objects, each containing:\n\nposition: 1-based position in the original sequence\nedit_distance: Number of edits (substitutions, insertions, deletions)\nalignment_length: Length of the alignment\n\nExamples\n\nfm = build_fmindex(dna\"ATCGATCG\")\nmatches = approximate_search(fm, dna\"ATGG\", max_edits=1)\n# Finds matches with up to 1 edit (e.g., ATCG at position 1 with substitution)\n\n\n\n\n\n","category":"method"},{"location":"#BurrowsWheeler.Search.backward_search-Union{Tuple{A}, Tuple{S}, Tuple{FMIndex{S, A}, BioSequences.BioSequence{A}}} where {S, A<:BioSequences.Alphabet}","page":"Overview","title":"BurrowsWheeler.Search.backward_search","text":"Backward search algorithm for FM-index pattern matching.\n\nThis function implements the backward search algorithm which processes the pattern from right to left, narrowing the suffix array range [sp, ep] at each step. All suffixes in the final range [sp, ep] begin with the pattern, ensuring they represent valid substring matches in the original sequence.\n\n\n\n\n\n","category":"method"},{"location":"#BurrowsWheeler.Search.build_fmindex-Union{Tuple{BioSequences.BioSequence{A}}, Tuple{A}} where A<:BioSequences.Alphabet","page":"Overview","title":"BurrowsWheeler.Search.build_fmindex","text":"build_fmindex(sequence::BioSequence{A}; sample_rate::Int64=32) where {A <: Alphabet}\n\nBuild an FM-index from a genomic sequence for efficient pattern matching.\n\nArguments\n\nsequence: The genomic sequence to index (DNA or RNA)\nsample_rate: Sampling rate for suffix array (default: 32). Lower values use more memory but enable faster position reporting.\n\nReturns\n\nAn FMIndex structure that can be used for pattern searching.\n\nExamples\n\nusing BurrowsWheeler\nusing BioSequences\n\nsequence = dna\"ATAATA\"\nfm = build_fmindex(sequence)\n\n\n\n\n\n","category":"method"},{"location":"#BurrowsWheeler.Search.count_occurrences-Union{Tuple{A}, Tuple{S}, Tuple{FMIndex{S, A}, BioSequences.BioSequence{A}}} where {S, A<:BioSequences.Alphabet}","page":"Overview","title":"BurrowsWheeler.Search.count_occurrences","text":"count_occurrences(fm::FMIndex{S, A}, pattern::BioSequence{A}) where {S, A <: Alphabet}\n\nCount the number of occurrences of a pattern in the indexed sequence.\n\nArguments\n\nfm: The FM-index to search in\npattern: The pattern to count\n\nReturns\n\nThe number of occurrences of the pattern (0 if not found).\n\nExamples\n\nfm = build_fmindex(dna\"ATAATA\")\ncount = count_occurrences(fm, dna\"ATA\")  # Returns 2\n\n\n\n\n\n","category":"method"},{"location":"#BurrowsWheeler.Search.locate-Union{Tuple{A}, Tuple{S}, Tuple{FMIndex{S, A}, BioSequences.BioSequence{A}}} where {S, A<:BioSequences.Alphabet}","page":"Overview","title":"BurrowsWheeler.Search.locate","text":"locate(fm::FMIndex{S, A}, pattern::BioSequence{A}) where {S, A <: Alphabet}\n\nFind all positions where a pattern occurs in the original sequence.\n\nThis function uses backward search to find all suffixes beginning with the pattern, then converts suffix array positions to actual sequence positions. Each returned position represents a valid substring match: the substring starting at that position in the original sequence matches the pattern exactly.\n\nArguments\n\nfm: The FM-index to search in\npattern: The pattern to locate\n\nReturns\n\nA sorted vector of 1-based positions where the pattern occurs in the original sequence. Each position pos represents a substring match: sequence[pos:pos+length(pattern)-1] == pattern. Returns an empty vector if the pattern is not found.\n\nExamples\n\nfm = build_fmindex(dna\"ATAATA\")\npositions = locate(fm, dna\"ATA\")  # Returns [1, 4]\n# Both positions represent valid matches:\n# sequence[1:3] == dna\"ATA\" and sequence[4:6] == dna\"ATA\"\n\n\n\n\n\n","category":"method"},{"location":"#BurrowsWheeler.Search.search-Union{Tuple{A}, Tuple{S}, Tuple{FMIndex{S, A}, BioSequences.BioSequence{A}}} where {S, A<:BioSequences.Alphabet}","page":"Overview","title":"BurrowsWheeler.Search.search","text":"search(fm::FMIndex{S, A}, pattern::BioSequence{A}) where {S, A <: Alphabet}\n\nSearch for a pattern in the FM-index using backward search.\n\nThe backward search algorithm finds all suffixes in the suffix array that begin with the pattern. This ensures that all positions in the returned range represent valid substring matches in the original sequence. The algorithm processes the pattern from right to left, narrowing the suffix array range at each step to guarantee correctness.\n\nArguments\n\nfm: The FM-index to search in\npattern: The pattern to search for\n\nReturns\n\nA tuple (sp, ep) where sp is the start position and ep is the end position in the suffix array. All suffixes in the range [sp, ep] begin with the pattern, representing valid substring matches. If the pattern is not found, returns (0, 0).\n\nExamples\n\nfm = build_fmindex(dna\"ATAATA\")\nsp, ep = search(fm, dna\"ATA\")\n\n\n\n\n\n","category":"method"}]
}
